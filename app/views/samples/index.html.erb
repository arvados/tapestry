<h2>Samples</h2>

<% if current_user.is_admin? %>
<p>Because you are an administrator, this page lists all samples by any researcher.</p>
<% else %>
<p>Listed below are the samples in your possession.</p>
<% end %>

<p>
  <%= link_to 'Enter IDs of received samples here', receive_sample_path %>
  when you receive samples from a participant or researcher.
</p>

<% if @samples.count > 0 %>
<%= will_paginate @samples %>
<table class="admin_table">
  <tr>
    <th>Number</th>
    <th>Study</th>
    <th>Kit</th>
    <th>Participant</th>
    <th>Owner</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>

<% @samples.each do |sample| %>
  <tr>
    <td><%= link_to sprintf("%08d", sample.crc_id), sample %></td>
    <td><%= sample.study.name %></td>
    <td><%= sample.kit.name %></td>
    <td><%= sample.participant.nil? ? '' : link_to(sample.participant.hex, public_profile_path(sample.participant.hex)) %></td>
    <td>
      <% if sample.owner.nil? %>
      <% elsif sample.owner.is_researcher? %>
      <%= sample.owner.full_name %>
      <% else %>
      <%= sample.owner.hex %>
      <% end %>
    </td>
    <td><%= link_to 'Log', show_sample_log_path(sample), :class => "iframe", :title => "Sample log for #{sample.name} (kit #{sample.kit.name})" %></td>
    <td><%= link_to 'Edit', edit_sample_path(sample) %></td>
    <td><%= sample.last_mailed.nil? ? link_to('Delete', sample, :confirm => 'Are you sure?', :method => :delete) : '' %></td>
  </tr>
<% end %>
</table>
<%= will_paginate @samples %>

<% end %>
